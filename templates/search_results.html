{% extends 'base.html' %}

{% block content %}
<div class="results-page-wrapper">
    <div class="results-header-container">
        <h1 class="results-main-title">âœˆï¸ Flight Search Results</h1>
        <div class="results-route-info">
            <strong>{{ origin }}</strong> 
            <span class="results-arrow">{% if trip_type in ['round-trip', 'round_trip'] %}â‡„{% else %}â†’{% endif %}</span> 
            <strong>{{ destination }}</strong>
            <span class="results-divider">|</span> 
            ğŸ“… {{ depart_date }}
        </div>
    </div>

    <div class="results-action-bar">
        <a href="/travel-ui" class="res-btn-action res-btn-back">
            â† Back to Search
        </a>
        <a href="https://search.hotellook.com/?location={{ destination[:3] }}&checkIn={{ depart_date }}&marker=665788&language=en" 
           target="_blank" class="res-btn-action res-btn-hotel">
            ğŸ  Find Hotels
        </a>
    </div>

    {% if flights %}
        <div class="results-count-text">Found {{ flights|length }} flights</div>
        
        {% for flight in flights %}
            <div class="flight-result-card">
                <div class="flight-result-header">
                    <div style="display: flex; align-items: center;">
                        <div class="airline-badge">{{ flight.airline_display }}</div>
                        <div style="margin-left: 15px; text-align: left;">
                            <div class="res-airline-name">{{ flight.airline }}</div>
                            <small class="res-trip-label">{{ trip_type }}</small>
                        </div>
                    </div>
                    <div class="res-price-tag">{{ flight.price }} {{ currency or 'SEK' }}</div>
                </div>
                
                <div class="flight-result-details">
                    <div class="res-time-block">
                        <div class="res-time-val">
                            {{ flight.depart.split(' ')[1][:5] if (flight.depart and ' ' in flight.depart) else flight.depart }}
                        </div>
                        <div class="res-city-code">{{ flight.origin }}</div>
                    </div>
                    
                    <div class="res-path-line">
                        <hr>
                        <span class="res-plane-icon">âœˆï¸</span>
                    </div>
                    
                    <div class="res-time-block">
                        <div class="res-time-val">{{ flight.arrival_time }}</div>
                        <div class="res-city-code">{{ flight.destination }}</div>
                    </div>
                </div>

                <a href="{{ flight.deeplink }}&dest={{ destination|urlencode }}" target="_blank" class="res-book-btn">
                    Book Flight â†’
                </a>
            </div>
        {% endfor %}
    {% else %}
        <div class="flight-result-card" style="text-align: center;">
            <h2 style="font-size: 22px;">ğŸ˜• No flights found</h2>
            <a href="/travel-ui" class="res-book-btn" style="max-width: 250px; margin: 20px auto;">Try Again</a>
        </div>
    {% endif %}
</div>
{% endblock %}